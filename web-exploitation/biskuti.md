# CTF Write-up: BISKUTI

**Category:** Web
**Challenge Source:** tcraCyber champion 2026
**Write-up Author:** TitoDevsec (T1t0D3v$3c)

## Challenge Summary
The challenge involved a web application where user roles were managed via HTTP headers or cookies. The goal was to escalate privileges from a normal user to an administrator.

## Vulnerability Analysis
### What was wrong?
The application trusted user-supplied input in the HTTP headers to determine the user's role. Specifically, a parameter named `Role` was found in the request header. This is a classic **Insecure Direct Object Reference (IDOR)** or **Broken Access Control** vulnerability.

## Solution
1.  **Interception:** Access the URL `http://<target-ip>:5010` and intercept the request using a tool like Burp Suite.
2.  **Identification:** Observe the HTTP headers. A header `Role: user` was identified.
3.  **Manipulation:** Change the header value from `user` to `admin`.
4.  **Exploitation:** Forward the modified request. The server, trusting the header, granted administrative privileges, revealing the flag.

## Code Comparison

### Vulnerable Code (Conceptual)
Trusting client-side headers for authorization:
```python
@app.route('/admin')
def admin_panel():
    role = request.headers.get('Role')
    if role == 'admin':
        return render_template('admin.html', flag=FLAG)
    return "Access Denied", 403
```

### Secure Code
Roles and permissions should be managed server-side, typically stored in a secure session or a database, and verified against a trusted identity provider.
```python
@app.route('/admin')
@login_required
def admin_panel():
    # Check role from a trusted server-side session
    if session.get('user_role') == 'admin':
        return render_template('admin.html', flag=FLAG)
    return "Access Denied", 403
```

## Lessons Learned
*   **Never trust client input:** Any data coming from the client (headers, cookies, POST data) can be manipulated and must be validated on the server.
*   **Secure Session Management:** Use secure, server-side sessions to track user roles and permissions.
*   **Principle of Least Privilege:** Ensure that users only have access to the resources necessary for their role.

## Flag
`tzcert{...}` (The specific flag was obtained after the privilege escalation).
